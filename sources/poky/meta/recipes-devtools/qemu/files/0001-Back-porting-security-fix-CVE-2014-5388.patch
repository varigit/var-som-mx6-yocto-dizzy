Prevent out-of-bounds array access on
acpi_pcihp_pci_status.

Upstream-Status: Backport

Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Signed-off-by: Sona Sarmadi <sona.sarmadi@enea.com>
---
v2:
 - change commit message.
 - add 'Reviewed-by'
---
 hw/acpi/pcihp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/hw/acpi/pcihp.c b/hw/acpi/pcihp.c
index fae663a..34dedf1 100644
--- a/hw/acpi/pcihp.c
+++ b/hw/acpi/pcihp.c
@@ -231,7 +231,7 @@ static uint64_t pci_read(void *opaque, hwaddr addr, unsigned int size)
     uint32_t val = 0;
     int bsel = s->hotplug_select;

-    if (bsel < 0 || bsel > ACPI_PCIHP_MAX_HOTPLUG_BUS) {
+    if (bsel < 0 || bsel >= ACPI_PCIHP_MAX_HOTPLUG_BUS) {
         return 0;
     }

--
1.7.12.4
